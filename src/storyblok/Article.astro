---
import { storyblokEditable } from "@storyblok/astro";
import Content from "./Content.astro";
import Summary from "../components/Summary.astro";
import slugify from "slugify";
import type { SummaryItems } from "../types/typesProps";

const { blok } = Astro.props;

const summary: SummaryItems[] = [];

interface blokTitle {
  component: string;
  title: string;
}

blok?.content.forEach((item: blokTitle) => {
  if (item.component === "title_two") {
    summary.push({ label: item.title, slug: slugify(item.title) });
  }
});
// console.log(blok);
---

<article {...storyblokEditable(blok)}>
  <div class="grid grid-cols-2 gap-x-8">
    <div>
      <h1 class="text-6xl text-mocha-900 font-bold mb-4">
        {blok.title}
      </h1>
      <p class="text-xl text-[#1d243d] font-[450] mb-4 text-balance">
        {blok.description}
      </p>
    </div>
    <div>
      <img
        class="object-cover h-[300px] object-center"
        width="624"
        height="300"
        src="https://picsum.photos/800/800"
        alt=""
      />
    </div>
  </div>
  <div class="mt-20 grid grid-cols-12 gap-24">
    <aside
      class="col-span-4 border-mocha-500 border-opacity-20 border-[1px] p-6 rounded-md self-start"
    >
      <p class="text-xl font-bold">Sommaire</p>
      <Summary summary={summary} />
    </aside>
    <div class="col-span-8">
      <Content bloks={blok.content} />
    </div>
  </div>
</article>
